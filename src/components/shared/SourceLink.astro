---
/**
 * Source link component
 * Displays clickable link to PDF source document
 */

import { sourceToPdfUrl, getSourceDisplayText } from '../../utils/sourceParser';

interface Props {
  source: string;
  showIcon?: boolean;
  className?: string;
}

const { source, showIcon = true, className = '' } = Astro.props;

const pdfUrl = sourceToPdfUrl(source);
const displayText = getSourceDisplayText(source);
const isValid = pdfUrl !== '#';
---

<a
  href={pdfUrl}
  target="_blank"
  rel="noopener noreferrer"
  class:list={[
    'inline-flex items-center gap-1.5 text-sm transition-colors',
    isValid
      ? 'text-sky-300 hover:text-sky-200 hover:underline'
      : 'text-slate-500 cursor-not-allowed',
    className
  ]}
  title={isValid ? `Open ${displayText} in new tab` : 'PDF source not available'}
>
  {showIcon && <span class="text-base" aria-hidden="true">ðŸ“„</span>}
  <span class="font-medium">{displayText}</span>
  {isValid && showIcon && <span class="text-xs" aria-hidden="true">â†—</span>}
</a>

<style>
  a[href="#"] {
    pointer-events: none;
  }
</style>
